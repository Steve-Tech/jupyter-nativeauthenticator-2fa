{% extends "page.html" %}

{% block main %}
<div class="container">
    <form action="{{post_url}}" method="post" role="form">
        <h1>
            Enable/Disable two factor authentication for {{user_name}}
        </h1>
        
        <p></p>

        {% if two_factor_auth %}
        <div class="form-group">
            {% if two_factor_auth_user %}
            <input type="submit" id="change_2fa_submit" class='btn btn-jupyter' value='Disable 2FA' />
            <p></p>
            {% else %}
            <input type="submit" id="change_2fa_submit" class='btn btn-jupyter' value='Enable 2FA' />
            <p></p>
            {% endif %}
        </div>
        {% else %}
        <p>
            <strong>Two factor authorization is not enabled on this server.</strong>
            You can turn it on by adding <pre>c.NativeAuthenticator.allow_2fa = True</pre> to the server's <pre>jupyterhub_config.py</pre> file.
        </p>
        {% endif %}
    </form>

    {% if result_message %}
        <div class="alert {{alert}} col-xs-6" role="alert">
            <p>
                {{result_message}}
            </p>
            
            {% if two_factor_auth_user %}
            <p>
                Two factor authentication secret for {{user_name}} is <strong>{{ two_factor_auth_secret }}</strong>.
                Please instruct the user to scan the QR code below or directly use the <a href="{{two_factor_auth_uri}}">OTP URI</a> with their authenticator app.
            </p>
            <img src="data:image/png;base64,{{two_factor_auth_qrcode}}" alt="{{two_factor_auth_uri}}">
            {% endif %}
        </div>
    {% endif %}
</div>
{% endblock %}
